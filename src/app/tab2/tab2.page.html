<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Registrar Lectura - Paso 1</ion-title>
    <ion-button slot="end" color="danger" (click)="confirmarCerrarSesion()">
      <ion-icon slot="icon-only" name="log-out"></ion-icon>
    </ion-button>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="content-wrapper">
    <!-- Información del usuario -->
    <ion-card class="user-info">
      <ion-card-content>
        <ion-text color="medium">
          <p><strong>Usuario:</strong> {{ userEmail }}</p>
          <p><strong>Paso 1:</strong> Foto del medidor y ubicación GPS</p>
        </ion-text>
      </ion-card-content>
    </ion-card>

    <!-- Sección de Foto del Medidor -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="camera" color="primary"></ion-icon>
          Fotografía del Medidor
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-button 
          expand="block" 
          (click)="seleccionarFotoMedidor()"
          [color]="lectura.foto_medidor ? 'success' : 'primary'"
        >
          <ion-icon slot="start" name="camera"></ion-icon>
          {{ lectura.foto_medidor ? 'Cambiar Foto' : 'Tomar Foto del Medidor' }}
        </ion-button>

        <div *ngIf="lectura.foto_medidor" class="preview-container ion-margin-top">
          <ion-img [src]="lectura.foto_medidor"></ion-img>
          <ion-icon name="checkmark-circle" color="success" class="check-icon"></ion-icon>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Sección de Ubicación GPS -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="locate" color="danger"></ion-icon>
          Ubicación GPS
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-button 
          expand="block"
          (click)="obtenerUbicacion()"
          [color]="locationObtained ? 'success' : 'primary'"
        >
          <ion-icon slot="start" name="locate"></ion-icon>
          {{ locationObtained ? 'Ubicación Obtenida' : 'Obtener Ubicación' }}
        </ion-button>

        <div *ngIf="locationObtained" class="location-info ion-margin-top">
          <ion-item>
            <ion-icon name="checkmark-circle" slot="start" color="success"></ion-icon>
            <ion-label>
              <h3>Ubicación Registrada</h3>
              <p>Latitud: {{ lectura.latitud?.toFixed(6) }}</p>
              <p>Longitud: {{ lectura.longitud?.toFixed(6) }}</p>
            </ion-label>
          </ion-item>
          <ion-button 
            expand="block" 
            fill="outline" 
            (click)="abrirEnMaps()"
            class="ion-margin-top"
          >
            <ion-icon slot="start" name="map"></ion-icon>
            Ver en Google Maps
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Instrucciones -->
    <ion-card color="light">
      <ion-card-content>
        <ion-text color="medium">
          <p><strong>Instrucciones:</strong></p>
          <p>1. Toma una foto clara del medidor</p>
          <p>2. Obtén tu ubicación GPS actual</p>
          <p>3. Continúa al paso 2 para completar el registro</p>
        </ion-text>
      </ion-card-content>
    </ion-card>

    <!-- Botón de Continuar -->
    <ion-button 
      expand="block" 
      color="success" 
      size="large"
      (click)="continuarATab3()"
      class="ion-margin-top"
    >
      <ion-icon slot="start" name="arrow-forward"></ion-icon>
      Continuar al Paso 2
    </ion-button>
  </div>
</ion-content>